{
  "hash": "6a5330bdd4630ad9e9615e9af1270e1c",
  "result": {
    "markdown": "---\ntitle: \"12 Régression de Poisson\"\ntoc: true\n---\n\n\n# Le modèle de Poisson\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMalaria <- read.table(\"../donnees/poissonData3.csv\", sep=\",\", header=T)\nsummary(Malaria)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Sexe                Age            Altitude     Prevention       \n Length:1627        Min.   :  10.0   Min.   :1129   Length:1627       \n Class :character   1st Qu.: 220.0   1st Qu.:1266   Class :character  \n Mode  :character   Median : 361.0   Median :1298   Mode  :character  \n                    Mean   : 419.4   Mean   :1295                     \n                    3rd Qu.: 555.0   3rd Qu.:1320                     \n                    Max.   :1499.0   Max.   :1515                     \n                                     NA's   :105                      \n     Duree          N.malaria     \n Min.   :   0.0   Min.   : 0.000  \n 1st Qu.: 172.0   1st Qu.: 1.000  \n Median : 721.0   Median : 4.000  \n Mean   : 619.3   Mean   : 4.687  \n 3rd Qu.:1011.0   3rd Qu.: 7.000  \n Max.   :1464.0   Max.   :26.000  \n                                  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodP <- glm(N.malaria ~ Duree, data = Malaria, family = poisson)\nmodP\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = N.malaria ~ Duree, family = poisson, data = Malaria)\n\nCoefficients:\n(Intercept)        Duree  \n   0.429459     0.001508  \n\nDegrees of Freedom: 1626 Total (i.e. Null);  1625 Residual\nNull Deviance:\t    5710 \nResidual Deviance: 3325 \tAIC: 8125\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(N.malaria ~ Duree, data = Malaria,pch=20,cex=0.5)\nmod.lin <- lm(N.malaria ~ Duree, data = Malaria)\nabline(a=coef(mod.lin)[1],b=coef(mod.lin)[2],lwd=2)\nx <- seq(0,1500,by=1)\ny <- exp(coef(modP)[1]+coef(modP)[2]*x)\nlines(x,y,col=\"red\",lty=2,lwd=2.5)\n```\n\n::: {.cell-output-display}\n![](chap12_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodP3 <- glm( N.malaria ~ Duree + Sexe + Prevention, \n              data = Malaria,family = poisson )\n```\n:::\n\n\n# Tests et intervalles de confiance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMalaria$Prevention <- as.factor(Malaria$Prevention)\nMalaria$Prevention <- relevel(Malaria$Prevention,ref=\"Rien\")\nmodP3 <- glm( N.malaria ~ Duree + Sexe + Prevention, data = Malaria,\n             family = poisson )\nsummary(modP3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = N.malaria ~ Duree + Sexe + Prevention, family = poisson, \n    data = Malaria)\n\nCoefficients:\n                            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                0.3878929  0.0389800   9.951   <2e-16 ***\nDuree                      0.0015101  0.0000343  44.031   <2e-16 ***\nSexeM                      0.0550890  0.0229690   2.398   0.0165 *  \nPreventionAutre           -0.2255828  0.1781379  -1.266   0.2054    \nPreventionMoustiquaire     0.0176850  0.0255967   0.691   0.4896    \nPreventionSerpentin/Spray  0.0196420  0.0590690   0.333   0.7395    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 5710.4  on 1626  degrees of freedom\nResidual deviance: 3317.3  on 1621  degrees of freedom\nAIC: 8124.6\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodP2 <- glm( N.malaria ~ Duree + Sexe, data = Malaria, family = poisson)\n-2*(logLik(modP2)-logLik(modP3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'log Lik.' 2.448823 (df=3)\n```\n:::\n\n```{.r .cell-code}\nqchisq(0.95,df=3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7.814728\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(modP2,modP3,test=\"LRT\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table\n\nModel 1: N.malaria ~ Duree + Sexe\nModel 2: N.malaria ~ Duree + Sexe + Prevention\n  Resid. Df Resid. Dev Df Deviance Pr(>Chi)\n1      1624     3319.8                     \n2      1621     3317.3  3   2.4488   0.4846\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nAnova(modP2,test=\"LR\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II tests)\n\nResponse: N.malaria\n      LR Chisq Df Pr(>Chisq)    \nDuree  2386.56  1    < 2e-16 ***\nSexe      5.45  1    0.01961 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nround(confint.default(modP3),3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                           2.5 % 97.5 %\n(Intercept)                0.311  0.464\nDuree                      0.001  0.002\nSexeM                      0.010  0.100\nPreventionAutre           -0.575  0.124\nPreventionMoustiquaire    -0.032  0.068\nPreventionSerpentin/Spray -0.096  0.135\n```\n:::\n\n```{.r .cell-code}\nround(confint(modP3),3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                           2.5 % 97.5 %\n(Intercept)                0.311  0.464\nDuree                      0.001  0.002\nSexeM                      0.010  0.100\nPreventionAutre           -0.596  0.105\nPreventionMoustiquaire    -0.032  0.068\nPreventionSerpentin/Spray -0.098  0.134\n```\n:::\n:::\n\n\n\n# Sélection de variables\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMalaria <- read.table(\"../donnees/poissonData.csv\", sep=\",\", header=T)\nMalaria1 <- na.omit(Malaria)\nMalaria1$Prevention <- as.factor(Malaria1$Prevention)\nMalaria1$Sexe <- as.factor(Malaria1$Sexe)\nlibrary(bestglm)\nmod_sel <- bestglm(Malaria1,family=poisson)\nmod_sel$BestModels\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Sexe   Age Altitude Prevention Duree Criterion\n1 FALSE  TRUE     TRUE      FALSE  TRUE  7384.946\n2 FALSE FALSE     TRUE      FALSE  TRUE  7387.814\n3  TRUE  TRUE     TRUE      FALSE  TRUE  7390.053\n4  TRUE FALSE     TRUE      FALSE  TRUE  7393.119\n5 FALSE  TRUE    FALSE      FALSE  TRUE  7401.021\n```\n:::\n:::\n",
    "supporting": [
      "chap12_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}