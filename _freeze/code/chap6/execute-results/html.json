{
  "hash": "e05a60cc9fae70d380917872e062e8d0",
  "result": {
    "markdown": "---\ntitle: \"6 Variables qualitatives : ANCOVA et ANOVA\"\ntoc: true\n---\n\n\n# La concentration en ozone\n\n\n::: {.cell}\n\n```{.r .cell-code}\nozone <- read.table(\"../donnees/ozone.txt\", header = T, sep = \";\")\nplot(ozone[,\"T12\"], ozone[,\"O3\"],pch=as.numeric(ozone[,\"vent\"]),\n     col = as.numeric(ozone[,\"vent\"]))\na1 <- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"EST\",])\na2 <- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"NORD\",])\na3 <- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"OUEST\",])\na4 <- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"SUD\",])\nabline(a1, col=1)\nabline(a2, col=2)\nabline(a3, col=3)\nabline(a4, col=4)\n```\n\n::: {.cell-output-display}\n![](chap6_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1b <- lm(formula = O3 ~ -1 + vent + T12:vent, data = ozone)\nsummary(mod1b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ -1 + vent + T12:vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.903  -9.163   1.153  10.319  32.638 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \nventEST        45.6090    13.9343   3.273 0.002133 ** \nventNORD      106.6345    28.0341   3.804 0.000456 ***\nventOUEST      64.6840    24.6208   2.627 0.011967 *  \nventSUD       -27.0602    26.5389  -1.020 0.313737    \nventEST:T12     2.7480     0.6342   4.333 8.96e-05 ***\nventNORD:T12   -1.6491     1.6058  -1.027 0.310327    \nventOUEST:T12   0.3407     1.2047   0.283 0.778709    \nventSUD:T12     5.3786     1.1497   4.678 3.00e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.71 on 42 degrees of freedom\nMultiple R-squared:  0.9773,\tAdjusted R-squared:  0.973 \nF-statistic: 226.1 on 8 and 42 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(formula = O3 ~ vent + T12:vent, data = ozone)\nsummary(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ vent + T12:vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.903  -9.163   1.153  10.319  32.638 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    45.6090    13.9343   3.273  0.00213 ** \nventNORD       61.0255    31.3061   1.949  0.05796 .  \nventOUEST      19.0751    28.2905   0.674  0.50384    \nventSUD       -72.6691    29.9746  -2.424  0.01972 *  \nventEST:T12     2.7480     0.6342   4.333 8.96e-05 ***\nventNORD:T12   -1.6491     1.6058  -1.027  0.31033    \nventOUEST:T12   0.3407     1.2047   0.283  0.77871    \nventSUD:T12     5.3786     1.1497   4.678 3.00e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.71 on 42 degrees of freedom\nMultiple R-squared:  0.6753,\tAdjusted R-squared:  0.6212 \nF-statistic: 12.48 on 7 and 42 DF,  p-value: 1.614e-08\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod2 <- lm(formula = O3 ~ vent + T12, data = ozone)\nmod2b <- lm(formula = O3 ~ -1 + vent + T12, data = ozone)\nmod3 <- lm(formula = O3 ~ vent:T12, data = ozone)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod2,mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent + T12\nModel 2: O3 ~ vent + T12:vent\n  Res.Df     RSS Df Sum of Sq      F   Pr(>F)   \n1     45 12612.0                                \n2     42  9087.4  3    3524.5 5.4298 0.003011 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nanova(mod3,mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent:T12\nModel 2: O3 ~ vent + T12:vent\n  Res.Df     RSS Df Sum of Sq      F  Pr(>F)  \n1     45 11864.1                              \n2     42  9087.4  3    2776.6 4.2776 0.01008 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(rstudent(mod2) ~ fitted(mod2),xlab=\"ychap\",ylab=\"residus\")\n```\n\n::: {.cell-output-display}\n![](chap6_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lattice)\nxyplot(rstudent(mod2)~fitted(mod2)|vent,data = ozone, ylab=\"residus\")\n```\n\n::: {.cell-output-display}\n![](chap6_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- lm(formula = O3 ~ vent + T12 + T12:vent, data = ozone)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod0 <- lm(formula = O3 ~ vent +T12 + T12:vent, data = ozone)\nsummary(mod0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ vent + T12 + T12:vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.903  -9.163   1.153  10.319  32.638 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    45.6090    13.9343   3.273  0.00213 ** \nventNORD       61.0255    31.3061   1.949  0.05796 .  \nventOUEST      19.0751    28.2905   0.674  0.50384    \nventSUD       -72.6691    29.9746  -2.424  0.01972 *  \nT12             2.7480     0.6342   4.333 8.96e-05 ***\nventNORD:T12   -4.3971     1.7265  -2.547  0.01462 *  \nventOUEST:T12  -2.4073     1.3614  -1.768  0.08429 .  \nventSUD:T12     2.6306     1.3130   2.004  0.05160 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.71 on 42 degrees of freedom\nMultiple R-squared:  0.6753,\tAdjusted R-squared:  0.6212 \nF-statistic: 12.48 on 7 and 42 DF,  p-value: 1.614e-08\n```\n:::\n:::\n\n\n\n# La hauteur des eucalyptus\n\n\n::: {.cell}\n\n```{.r .cell-code}\neucalypt <- read.table(\"../donnees/eucalyptus.txt\", header = T, sep = \";\")\neucalypt[,\"bloc\"] <- as.factor(eucalypt[,\"bloc\"])\nm.complet <- lm(ht ~ bloc - 1 + bloc:circ, data = eucalypt)\nm.pente <- lm(ht ~ bloc - 1 + circ, data = eucalypt)\nm.ordonne <- lm(ht ~ bloc:circ, data = eucalypt)\nanova(m.pente, m.complet)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: ht ~ bloc - 1 + circ\nModel 2: ht ~ bloc - 1 + bloc:circ\n  Res.Df    RSS Df Sum of Sq      F Pr(>F)\n1   1425 2005.9                           \n2   1423 2005.0  2   0.84752 0.3007 0.7403\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m.ordonne, m.complet)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: ht ~ bloc:circ\nModel 2: ht ~ bloc - 1 + bloc:circ\n  Res.Df    RSS Df Sum of Sq      F Pr(>F)\n1   1425 2009.2                           \n2   1423 2005.0  2    4.1649 1.4779 0.2285\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm.simple <- lm(ht ~ circ, data = eucalypt)\nanova(m.simple, m.pente)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: ht ~ circ\nModel 2: ht ~ bloc - 1 + circ\n  Res.Df    RSS Df Sum of Sq      F    Pr(>F)    \n1   1427 2052.1                                  \n2   1425 2005.9  2    46.188 16.406 9.031e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n# ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(O3~vent-1,data=ozone)\nsummary(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ vent - 1, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n          Estimate Std. Error t value Pr(>|t|)    \nventEST    103.850      4.963   20.92  < 2e-16 ***\nventNORD    78.289      6.618   11.83 1.49e-15 ***\nventOUEST   71.578      4.680   15.30  < 2e-16 ***\nventSUD     94.343      7.504   12.57  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.9547,\tAdjusted R-squared:  0.9508 \nF-statistic: 242.4 on 4 and 46 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: O3\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nvent       4 382244   95561  242.44 < 2.2e-16 ***\nResiduals 46  18131     394                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod2 <- lm(O3 ~ vent, data = ozone)\nanova(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: O3\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nvent       3  9859.8  3286.6  8.3383 0.0001556 ***\nResiduals 46 18131.4   394.2                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  103.850      4.963  20.923  < 2e-16 ***\nventNORD     -25.561      8.272  -3.090  0.00339 ** \nventOUEST    -32.272      6.821  -4.731 2.16e-05 ***\nventSUD       -9.507      8.997  -1.057  0.29616    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.3522,\tAdjusted R-squared:   0.31 \nF-statistic: 8.338 on 3 and 46 DF,  p-value: 0.0001556\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(O3 ~ C(vent,treatment), data = ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ C(vent, treatment), data = ozone)\n\nCoefficients:\n            (Intercept)   C(vent, treatment)NORD  C(vent, treatment)OUEST  \n                103.850                  -25.561                  -32.272  \n  C(vent, treatment)SUD  \n                 -9.507  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(O3 ~ C(vent,base=2), data = ozone)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ C(vent, base = 2), data = ozone)\n\nCoefficients:\n           (Intercept)    C(vent, base = 2)EST  C(vent, base = 2)OUEST  \n                78.289                  25.561                  -6.711  \n  C(vent, base = 2)SUD  \n                16.054  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nII <- length(levels(as.factor(ozone$vent)))\nnI <- table(ozone$vent)\ncontraste<-matrix(rbind(diag(II-1),-nI[-II]/nI[II]),II,II-1)\nmod3 <- lm(O3 ~ C(vent,contraste), data = ozone)\nanova(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: O3\n                   Df  Sum Sq Mean Sq F value    Pr(>F)    \nC(vent, contraste)  3  9859.8  3286.6  8.3383 0.0001556 ***\nResiduals          46 18131.4   394.2                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ C(vent, contraste), data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           86.300      2.808  30.737  < 2e-16 ***\nC(vent, contraste)1   17.550      4.093   4.288 9.15e-05 ***\nC(vent, contraste)2   -8.011      5.993  -1.337 0.187858    \nC(vent, contraste)3  -14.722      3.744  -3.933 0.000281 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.3522,\tAdjusted R-squared:   0.31 \nF-statistic: 8.338 on 3 and 46 DF,  p-value: 0.0001556\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod4 <- lm(O3 ~ C(vent,sum), data = ozone) \nanova(mod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: O3\n             Df  Sum Sq Mean Sq F value    Pr(>F)    \nC(vent, sum)  3  9859.8  3286.6  8.3383 0.0001556 ***\nResiduals    46 18131.4   394.2                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(mod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ C(vent, sum), data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     87.015      3.027  28.743  < 2e-16 ***\nC(vent, sum)1   16.835      4.635   3.632 0.000705 ***\nC(vent, sum)2   -8.726      5.573  -1.566 0.124284    \nC(vent, sum)3  -15.437      4.485  -3.442 0.001240 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.3522,\tAdjusted R-squared:   0.31 \nF-statistic: 8.338 on 3 and 46 DF,  p-value: 0.0001556\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresid2 <- resid(mod2)\nozone$vent <- as.factor(ozone$vent)\nplot(resid2~vent,data=ozone, ylab=\"residus\")\n```\n\n::: {.cell-output-display}\n![](chap6_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(resid2 ~ jitter(fitted(mod2)),xlab=\"ychap\",ylab=\"residus\")\n```\n\n::: {.cell-output-display}\n![](chap6_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n\n```{.r .cell-code}\nxyplot(resid2 ~ I(1:50)|vent, data=ozone,\n       xlab=\"index\", ylab=\"residus\")\n```\n\n::: {.cell-output-display}\n![](chap6_files/figure-html/unnamed-chunk-20-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\nwith(ozone, interaction.plot(vent, nebulosite, O3, col=1:2))\nwith(ozone, interaction.plot(nebulosite, vent, O3, col=1:4))\n```\n\n::: {.cell-output-display}\n![](chap6_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(O3 ~ vent + nebulosite + vent:nebulosite, data = ozone)\nmod2 <- lm(O3 ~ vent + nebulosite, data = ozone)\nanova(mod2, mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent + nebulosite\nModel 2: O3 ~ vent + nebulosite + vent:nebulosite\n  Res.Df   RSS Df Sum of Sq     F Pr(>F)\n1     45 11730                          \n2     42 11246  3    483.62 0.602 0.6173\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod3 <- lm(O3 ~ vent, data = ozone)\nanova(mod3, mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent\nModel 2: O3 ~ vent + nebulosite\n  Res.Df   RSS Df Sum of Sq      F    Pr(>F)    \n1     46 18131                                  \n2     45 11730  1    6401.5 24.558 1.066e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod3, mod2, mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent\nModel 2: O3 ~ vent + nebulosite\nModel 3: O3 ~ vent + nebulosite + vent:nebulosite\n  Res.Df   RSS Df Sum of Sq      F    Pr(>F)    \n1     46 18131                                  \n2     45 11730  1    6401.5 23.907 1.523e-05 ***\n3     42 11246  3     483.6  0.602    0.6173    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: O3\n                Df  Sum Sq Mean Sq F value    Pr(>F)    \nvent             3  9859.8  3286.6  12.274 6.689e-06 ***\nnebulosite       1  6401.5  6401.5  23.907 1.523e-05 ***\nvent:nebulosite  3   483.6   161.2   0.602    0.6173    \nResiduals       42 11246.2   267.8                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n",
    "supporting": [
      "chap6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}