{
  "hash": "f00ad24c8cd2575de3f16ee84d5d04f1",
  "result": {
    "markdown": "---\ntitle: \"8 Régression sous contraintes de norme : ridge, lasso, elastic net\"\ntoc: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nozone <- read.table(\"../donnees/ozone.txt\",header=TRUE,sep=\";\",row.names=1)[,-c(11:12)]\nozone.X <- model.matrix(O3 ~ ., data = ozone)[,-1]\nozone.Y <- ozone$O3\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(glmnet)\nridge <- glmnet(ozone.X, ozone.Y, alpha = 0)\nlasso <- glmnet(ozone.X, ozone.Y)#par défaut alpha=1\nen <- glmnet(ozone.X, ozone.Y, alpha = 0.5)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ridge,main=\"Ridge\",ylim=c(-2,2))\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(ridge,xvar=\"lambda\",main=\"Ridge\",ylim=c(-2,2))\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(lasso,main=\"Lasso\",ylim=c(-2,2))\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(lasso,xvar=\"lambda\",main=\"Lasso\",ylim=c(-2,2))\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(en,main=\"Elastic net\",ylim=c(-2,2))\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-3-5.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(en,xvar=\"lambda\",main=\"Elastic net\",ylim=c(-2,2))\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-3-6.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\ncv.ridge <- cv.glmnet(ozone.X, ozone.Y, alpha = 0)\ncv.lasso <- cv.glmnet(ozone.X, ozone.Y) #alpha=1 par défaut\ncv.en <- cv.glmnet(ozone.X, ozone.Y, alpha = 0.5)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncv.ridge$lambda.min\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4.619799\n```\n:::\n\n```{.r .cell-code}\ncv.ridge$lambda.1se\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 29.69641\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(cv.ridge, main = \"Ridge\")\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(cv.lasso, main = \"Lasso\")\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(cv.en, main = \"Elastic net\")\n```\n\n::: {.cell-output-display}\n![](chap8_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nxnew <- ozone.X[c(25,30),]\nrownames(xnew) <- NULL\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nxnew\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      T12  T15 Ne12 N12 S12 E12 W12   Vx   O3v\n[1,] 13.6 14.4    1   0   0   1   0 3.55  97.8\n[2,] 21.8 23.6    6   4   0   0   0 2.50 112.0\n```\n:::\n\n```{.r .cell-code}\npredict(cv.ridge,newx=xnew)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     lambda.1se\n[1,]   90.41122\n[2,]   90.65036\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nozone<-read.table(\"../donnees/ozone.txt\",header=TRUE,sep=\";\",row.names = 1)\nozone.X <- model.matrix(O3~.,data=ozone)\nozone.Y <- ozone$O3\ncv.defaut <- cv.glmnet(ozone.X,ozone.Y)\nlassodefaut<-glmnet(ozone.X,ozone.Y,lambda=cv.defaut$lambda.min)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nozone$vent <- as.factor(ozone$vent)\nozone$vent <- relevel(ozone$vent,ref=\"NORD\")\nozone.X <- model.matrix(O3~.,data=ozone)\ncv.nord <- cv.glmnet(ozone.X,ozone.Y)\nlassonord <- glmnet(ozone.X,ozone.Y,lambda=cv.nord$lambda.min)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(lassodefaut,ozone.X[1:4,])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               s0\n19960422 73.05686\n19960429 92.67573\n19960506 69.26897\n19960514 80.69977\n```\n:::\n\n```{.r .cell-code}\npredict(lassonord,ozone.X[1:4,])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               s0\n19960422 79.43741\n19960429 90.58414\n19960506 74.36556\n19960514 75.06648\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nozone.X <- model.matrix(O3~.-vent-nebulosite+C(vent,sum)+\n                          C(nebulosite,sum),data=ozone)\ncv.sum <- cv.glmnet(ozone.X,ozone.Y)\nlassosum <- glmnet(ozone.X,ozone.Y,lambda=cv.sum$lambda.min)\npredict(lassosum,ozone.X[1:4,])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               s0\n19960422 78.05238\n19960429 89.87258\n19960506 75.07092\n19960514 73.93502\n```\n:::\n:::\n",
    "supporting": [
      "chap8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}