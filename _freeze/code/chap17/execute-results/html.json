{
  "hash": "7bd6bb6598fa0985daccbe26d1bcd74d",
  "result": {
    "markdown": "---\ntitle: \"17 Estimateurs à noyau et $k$ plus proches voisins\"\ntoc: true\n---\n\n\n# Estimateurs à noyau\n\n\n::: {.cell}\n\n```{.r .cell-code}\nozone <- read.table(\"../donnees/ozone.txt\",header=TRUE,sep=\";\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nind <- order(ozone[,\"T12\"])\nT12o <- ozone[ind,\"T12\"]\nO3o <- ozone[ind,\"O3\"]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreg1 <- lm(O3o~1,weight=c(rep(1,10),rep(0,40)))\nreg2 <- lm(O3o~1,weight=c(rep(0,10),rep(1,10),rep(0,30)))\nreg3 <- lm(O3o~1,weight=c(rep(0,20),rep(1,10),rep(0,20)))\nreg4 <- lm(O3o~1,weight=c(rep(0,30),rep(1,10),rep(0,10)))\nreg5 <- lm(O3o~1,weight=c(rep(0,40),rep(1,10)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(T12o,O3o,pch=20,xlab=\"T12\",ylab=\"O3\")\nabline(v=c(14,18),col=\"red\",lwd=2)\nabline(v=c(16),col=\"blue\",lty=2)\npoints(16,mean(O3o[T12o>=14 & T12o<=18]),col=\"blue\",pch=17,cex=1.5)\n```\n\n::: {.cell-output-display}\n![](chap17_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ibr)\nx <- seq(7,30,by=0.01)\npar(mfrow=c(1,3))\nh <- c(20,3,0.05)\nfor (i in h){\n  plot(T12o,O3o,pch=20,xlab=\"T12\",ylab=\"O3\")\n  tmp <- npregress(T12o,O3o,bandwidth = i)\n  prev <- predict(tmp,newdata=x)\n  lines(x,prev,col=\"blue\",lwd=2)\n}\n```\n\n::: {.cell-output-display}\n![](chap17_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n# Les $k$ plus proches voisins\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,3))\nlibrary(FNN)\nk <- c(50,10,1)\nfor (i in k){\n  mod <- knn.reg(train=T12o,test=as.matrix(x),y=O3o,k=i)\n  plot(T12o,O3o,pch=20,xlab=\"T12\",ylab=\"O3\")\n  lines(x,mod$pred,col=\"blue\",lwd=2)\n}\n```\n\n::: {.cell-output-display}\n![](chap17_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# Sélection des paramètres\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhcv <- npregress(T12o,O3o)$bandwidth\nhcv\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.688373\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknn.reg(train=T12o,y=O3o,k=10)$PRESS/length(T12o)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 287.6629\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nK_cand <- 1:49\nloo <- rep(0,length(K_cand))\nfor (i in 1:length(K_cand)){\n  loo[i] <- knn.reg(train=T12o,y=O3o,k=K_cand[i])$PRESS/length(T12o)\n}\nK_cand[which.min(loo)]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod.kppv <- knn.reg(train=T12o,test=as.matrix(x),y=O3o,k=8)\nmod.noyau <- npregress(T12o,O3o,bandwidth = hcv)\nprev.noyau <- predict(mod.noyau,newdata=x)\nplot(T12o,O3o,pch=20,xlab=\"T12\",ylab=\"O3\")\nlines(x,mod.kppv$pred,col=\"blue\",lwd=2)\nlines(x,prev.noyau,col=\"red\",lty=2,lwd=2)\n```\n\n::: {.cell-output-display}\n![](chap17_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod.noyau$df\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5.339428\n```\n:::\n:::\n",
    "supporting": [
      "chap17_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}