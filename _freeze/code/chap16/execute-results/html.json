{
  "hash": "0de647bdd180b4a262692b4466f4a3a6",
  "result": {
    "markdown": "---\ntitle: \"16 Introduction à la régression spline\"\ntoc: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nozone <- read.table(\"../donnees/ozone_simple.txt\",header=T,sep=\";\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npolyreg <- function(donnee,d=3){\n  sigmax <- sd(donnee[,\"T12\"])\n  grillex <- seq(min(donnee[,\"T12\"])-sigmax,max(donnee[,\"T12\"])+sigmax,length=100)\n  aprevoir <- data.frame(T12=grillex)\n  regpol <- lm(O3~poly(T12,degree=d,raw=TRUE),data=donnee)\n  prev <- predict(regpol,aprevoir)\n  return(list(grillex=grillex,grilley=prev))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(O3~T12,data=ozone,xlab=\"T12\",ylab=\"O3\")\niter <- 1\nfor(ii in c(1,2,3,9)){\n tmp <- polyreg(ozone,d=ii)\n lines(tmp$grillex,tmp$grilley,col=iter,lty=iter)\n iter <- iter+1\n}\nlegend(15,150,c(\"d=1\",\"d=2\",\"d=3\",\"d=9\"),col=1:4,lty=1:4)\n```\n\n::: {.cell-output-display}\n![](chap16_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nind <- which(ozone[,2]<23)\nregd <- lm(O3~T12,data=ozone[ind,])\nregf <- lm(O3~T12,data=ozone[-ind,])\ngxd <- seq(3,23,length=50)\ngyd <- regd$coef[1]+gxd*regd$coef[2]\ngxf <- seq(23,35,length=50)\ngyf <- regf$coef[1]+gxf*regf$coef[2]\nplot(O3~T12,data=ozone)\nlines(gxd,gyd,col=2,lty=1,lwd=2)\nlines(gxf,gyf,col=2,lty=1,lwd=2)\nabline(v=23)\n```\n\n::: {.cell-output-display}\n![](chap16_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(splines)\nXB <- bs(ozone[,2], knots=c(15,23), degree=2,Boundary.knots=c(5,32))\nregs <- lm(ozone[,\"O3\"] ~ XB)\nregs$coef\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)         XB1         XB2         XB3         XB4 \n  51.101947   61.543761    5.562286   70.459103  106.711539 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngrillex <- seq(5,32,length=100)\nbgrillex <- bs(grillex, knots=c(15,23), degree=2,Boundary.knots=c(5,32))\nprev <- bgrillex%*%as.matrix(regs$coeff[-1])+regs$coeff[1]\nplot(O3~T12,data=ozone)\nlines(grillex,prev,col=2)\nabline(v=c(15,23))\n```\n\n::: {.cell-output-display}\n![](chap16_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nregssplinel1 <- smooth.spline(ozone[,2],ozone[,1],lambda =100)\nprevl1 <- predict(regssplinel1,grillex)\nplot(O3~T12,data=ozone)\nlines(prevl1$x,prevl1$y,col=2)\n```\n\n::: {.cell-output-display}\n![](chap16_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nregsspline <- smooth.spline(ozone[,2],ozone[,1])\nprev <- predict(regsspline,grillex)\nplot(O3~T12,data=ozone)\nlines(prev$x,prev$y,col=2)\n```\n\n::: {.cell-output-display}\n![](chap16_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nregsspline\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nsmooth.spline(x = ozone[, 2], y = ozone[, 1])\n\nSmoothing Parameter  spar= 0.9410342  lambda= 0.006833357 (15 iterations)\nEquivalent Degrees of Freedom (Df): 4.156771\nPenalized Criterion (RSS): 11036.88\nGCV: 289.8012\n```\n:::\n:::\n",
    "supporting": [
      "chap16_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}