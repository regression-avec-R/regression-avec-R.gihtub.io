{
  "hash": "a4276740da15a288faf3e285273cdb6d",
  "result": {
    "markdown": "---\ntitle: \"5 Inférence dans le modèle Gaussien\"\ntoc: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nozone <- read.table(\"../donnees/ozone.txt\", header = T, sep = \";\")\nmodele3 <- lm(O3 ~ T12 + Vx + Ne12, data = ozone)\nresume3 <- summary(modele3)\ncoef3 <- coef(resume3)\nIC3 <- t(confint(modele3, level = 0.95))\nIC3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       (Intercept)       T12        Vx      Ne12\n2.5 %     57.15842 0.3138112 0.1491857 -6.960609\n97.5 %   111.93625 2.3162807 0.8237055 -2.826137\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ellipse)\npar(mfrow=c(3,2))\nfor(i in 1:3){\n  for(j in (i+1):4){\n    plot(ellipse(modele3,c(i,j),level=0.95),type=\"l\",\n         xlab=paste(\"beta\",i,sep=\"\"),ylab=paste(\"beta\",j,sep=\"\"))\n    points(coef(modele3)[i], coef(modele3)[j],pch=3)\n    lines(c(IC3[1,i],IC3[1,i],IC3[2,i],IC3[2,i],IC3[1,i]),\n          c(IC3[1,j],IC3[2,j],IC3[2,j],IC3[1,j],IC3[1,j]),lty=2)\n  }\n}\n```\n\n::: {.cell-output-display}\n![](chap5_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nc(resume3$sigma^2*modele3$df.res/qchisq(0.975,modele3$df.res),\n  resume3$sigma^2*modele3$df.res/qchisq(0.025,modele3$df.res))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 133.6699 305.3706\n```\n:::\n:::\n\n\n\n# Exemple 1 : la concentration en ozone\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodele3 <- lm(O3 ~ T12 + Vx + Ne12, data = ozone)\nresume3 <- summary(modele3)\nresume3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = O3 ~ T12 + Vx + Ne12, data = ozone)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-29.0461  -8.4824   0.7861   7.7024  28.2916 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  84.5473    13.6067   6.214 1.38e-07 ***\nT12           1.3150     0.4974   2.644  0.01117 *  \nVx            0.4864     0.1675   2.903  0.00565 ** \nNe12         -4.8934     1.0270  -4.765 1.93e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 13.91 on 46 degrees of freedom\nMultiple R-squared:  0.6819,\tAdjusted R-squared:  0.6611 \nF-statistic: 32.87 on 3 and 46 DF,  p-value: 1.663e-11\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodele2 <- lm(O3 ~ T12 + Vx, data = ozone)\nanova(modele2, modele3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: O3 ~ T12 + Vx\nModel 2: O3 ~ T12 + Vx + Ne12\n  Res.Df     RSS Df Sum of Sq      F    Pr(>F)    \n1     47 13299.4                                  \n2     46  8904.6  1    4394.8 22.703 1.927e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n# Exemple 2 : la hauteur des eucalyptus\n\n\n::: {.cell}\n\n```{.r .cell-code}\neucalypt <- read.table(\"../donnees/eucalyptus.txt\", header = T, sep = \";\")\nregsimple <- lm(ht ~ circ, data = eucalypt)\nregM <- lm(ht ~ circ + I(sqrt(circ)), data = eucalypt)\nanova(regsimple, regM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: ht ~ circ\nModel 2: ht ~ circ + I(sqrt(circ))\n  Res.Df    RSS Df Sum of Sq     F    Pr(>F)    \n1   1427 2052.1                                 \n2   1426 1840.7  1    211.43 163.8 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(regM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ht ~ circ + I(sqrt(circ)), data = eucalypt)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.1881 -0.6881  0.0427  0.7927  3.7481 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   -24.35200    2.61444  -9.314   <2e-16 ***\ncirc           -0.48295    0.05793  -8.336   <2e-16 ***\nI(sqrt(circ))   9.98689    0.78033  12.798   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.136 on 1426 degrees of freedom\nMultiple R-squared:  0.7922,\tAdjusted R-squared:  0.7919 \nF-statistic:  2718 on 2 and 1426 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngrille <- data.frame(circ = seq(min(eucalypt[,\"circ\"]),\n                                max(eucalypt[,\"circ\"]), len = 100))\nICdte <- predict(regM,new=grille,interval=\"conf\",level=0.95)\nICpre <- predict(regM,new=grille,interval=\"pred\",level=0.95)\nplot(ht ~ circ, data = eucalypt, pch=\"+\", col=\"grey60\")\nmatlines(grille,cbind(ICdte,ICpre[,-1]),lty=c(1,2,2,3,3),col=1)\nlegend(\"topleft\", lty=2:3, c(\"E(Y)\",\"Y\"))\n```\n\n::: {.cell-output-display}\n![](chap5_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n# Intervalle de confiance bootstrap\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodele3 <- lm(O3 ~ T12 + Vx + Ne12, data = ozone)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresume3 <- summary(modele3)\nresume3$coef[,1:2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Estimate Std. Error\n(Intercept) 84.5473326 13.6067253\nT12          1.3150459  0.4974102\nVx           0.4864456  0.1675496\nNe12        -4.8933729  1.0269960\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- residuals(modele3)\nychap <- predict(modele3)\nCOEFF <- matrix(0, ncol = 4, nrow = 1000)\ncolnames(COEFF) <- names(coef(modele3))\nozone.boot <- ozone\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in 1:nrow(COEFF)){\n  resetoile <- sample(res, length(res), replace=T)\n  O3etoile <- ychap + resetoile\n  ozone.boot[,\"O3\"] <- O3etoile\n  regboot <- lm(formula(modele3), data=ozone.boot)\n  COEFF[i,] <- coef(regboot)\n }\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\napply(COEFF, 2, quantile, probs = c(0.025,0.975))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      (Intercept)       T12        Vx      Ne12\n2.5%     59.31069 0.3940245 0.2036312 -6.775764\n97.5%   108.67459 2.2270745 0.7974850 -2.900857\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(COEFF[,\"T12\"], main = \"\", xlab = \"Coefficient de T12\")\n```\n\n::: {.cell-output-display}\n![](chap5_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "chap5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}