{
  "hash": "776753dfc64d997aa015e267907e8cb3",
  "result": {
    "markdown": "---\ntitle: \"9 Régression sur composantes : PCR et PLS\"\ntoc: true\n---\n\n\n# Régression MCO et choix de variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nozone <- read.table(\"../donnees/ozone.txt\",header=TRUE,sep=\";\",row.names=1)\nmodeleinit <- lm(O3 ~ ., data = ozone[,1:10])\nround(coefficients(modeleinit),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)         T12         T15        Ne12         N12         S12 \n      54.73       -0.35        1.50       -4.19        1.28        3.17 \n        E12         W12          Vx         O3v \n       0.53        2.47        0.61        0.25 \n```\n:::\n\n```{.r .cell-code}\nBIC(modeleinit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 431.8923\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(leaps)\nchoix <- regsubsets(O3 ~ .,nbest=1,nvmax=10,data=ozone[,1:10])\nresume <- summary(choix)\nindmin <- which.min(resume$bic)\nnomselec <- colnames(resume$which)[resume$which[indmin,]][-1]\nformule <- formula(paste(\"O3~\",paste(nomselec,collapse=\"+\")))\nmodeleBIC <- lm(formule,data=ozone[,1:10])\nround(coefficients(modeleBIC),2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)         T15        Ne12          Vx         O3v \n      61.83        1.06       -3.99        0.31        0.26 \n```\n:::\n\n```{.r .cell-code}\nBIC(modeleBIC)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 415.8866\n```\n:::\n:::\n\n# Mise en place des données centrées réduites\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- ozone[,2:10]\nXbar  <- apply(X, 2, mean)\nstdX <- sqrt(apply(X, 2, var))\nXcr <- scale(X, center = Xbar, scale = stdX)\n```\n:::\n\n\n\n# PCR\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pls)\nset.seed(87)\ncvseg <- cvsegments(nrow(ozone), k = 4, type = \"random\")\nn.app <- nrow(ozone)\nmodele.pcr <- pcr(O3 ~ ., ncomp=9, data=ozone[,1:10], scale=T,\n                   validation = \"CV\", segments = cvseg)\nmsepcv.pcr <- MSEP(modele.pcr ,estimate=c(\"train\",\"CV\")) \nmsepcv.pcr\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\ntrain        559.8    188.7    186.5    185.2    179.8    158.8    152.0\nCV           582.9    260.4    260.6    278.2    271.3    239.3    248.1\n       7 comps  8 comps  9 comps\ntrain    143.9    142.5    139.7\nCV       242.1    244.0    239.4\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnpcr <- which.min(msepcv.pcr$val[\"CV\",,])-1\nmodele.pcr.fin <- pcr(O3 ~ ., ncomp = npcr, scale = TRUE,data = ozone[,1:10])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- ozone[,2:10]\nY <- ozone[,1]\nn <- nrow(X)\nXbar  <- apply(X,2,mean)\nstdX <- sqrt(apply(X,2,var)*(n-1)/n)\nYbar <- mean(Y)\nmodele.pcr.fin <- pcr(O3~.,ncomp=1,scale=TRUE,data =ozone[,1:10])\nbetafinpcr <- matrix(coefficients(modele.pcr.fin),ncol=1)/stdX\nmu <- mean(Y)-Xbar%*%betafinpcr\nc(mu,betafinpcr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 48.3373569  0.7884931  0.8236705 -1.7618991 -0.6760911  0.2126764\n [7]  1.6099503 -1.4694047  0.3118176  0.1662505\n```\n:::\n:::\n\n\n# PLS\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(87)\ncvseg <- cvsegments(nrow(ozone), k = 4, type = \"random\")\nn.app <- nrow(ozone)\nmodele.pls <- plsr(O3 ~ ., ncomp=9, data = ozone[,1:10], scale=T,validation = \"CV\", segments = cvseg)\nmsepcv.pls <- MSEP(modele.pls ,estimate=c(\"train\",\"CV\")) \nmsepcv.pls\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps\ntrain        559.8    173.9    150.9    146.9    144.2    142.1    141.4\nCV           582.9    251.9    248.4    245.3    234.6    241.7    243.6\n       7 comps  8 comps  9 comps\ntrain    140.9    139.8    139.7\nCV       234.7    239.6    239.4\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnpls <- which.min(msepcv.pls$val[\"CV\",,])-1\nmodele.pls.fin <- plsr(O3~ . , ncomp  =npls, scale = TRUE,data = ozone[,1:10])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- ozone[,2:10]\nY <- ozone[,1]\nn <- nrow(X)\nXbar  <- apply(X,2,mean)\nstdX <- sqrt(apply(X,2,var)*(n-1)/n)\nYbar <- mean(Y)\nmodele.pls.fin <- plsr(O3~.,ncomp=1,scale=TRUE,data =ozone[,1:10])\nbetafinpls <- matrix(coefficients(modele.pls.fin),ncol=1)/stdX\nmu <- mean(Y)-Xbar%*%betafinpls\nc(mu,betafinpls)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 47.1060475  0.8151834  0.8471154 -2.1910455 -0.5175855  0.3563688\n [7]  1.3005636 -1.2552108  0.2805513  0.1920499\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}