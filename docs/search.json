[
  {
    "objectID": "code/chap8.html",
    "href": "code/chap8.html",
    "title": "8 Régression sous contraintes de norme : ridge, lasso, elastic net",
    "section": "",
    "text": "ozone &lt;- read.table(\"../donnees/ozone.txt\",header=TRUE,sep=\";\",row.names=1)[,-c(11:12)]\nozone.X &lt;- model.matrix(O3 ~ ., data = ozone)[,-1]\nozone.Y &lt;- ozone$O3\n\n\nlibrary(glmnet)\nridge &lt;- glmnet(ozone.X, ozone.Y, alpha = 0)\nlasso &lt;- glmnet(ozone.X, ozone.Y)#par défaut alpha=1\nen &lt;- glmnet(ozone.X, ozone.Y, alpha = 0.5)\n\n\nplot(ridge,main=\"Ridge\",ylim=c(-2,2))\n\n\n\nplot(ridge,xvar=\"lambda\",main=\"Ridge\",ylim=c(-2,2))\n\n\n\nplot(lasso,main=\"Lasso\",ylim=c(-2,2))\n\n\n\nplot(lasso,xvar=\"lambda\",main=\"Lasso\",ylim=c(-2,2))\n\n\n\nplot(en,main=\"Elastic net\",ylim=c(-2,2))\n\n\n\nplot(en,xvar=\"lambda\",main=\"Elastic net\",ylim=c(-2,2))\n\n\n\n\n\nset.seed(1234)\ncv.ridge &lt;- cv.glmnet(ozone.X, ozone.Y, alpha = 0)\ncv.lasso &lt;- cv.glmnet(ozone.X, ozone.Y) #alpha=1 par défaut\ncv.en &lt;- cv.glmnet(ozone.X, ozone.Y, alpha = 0.5)\n\n\ncv.ridge$lambda.min\n\n[1] 4.619799\n\ncv.ridge$lambda.1se\n\n[1] 29.69641\n\n\n\nplot(cv.ridge, main = \"Ridge\")\n\n\n\nplot(cv.lasso, main = \"Lasso\")\n\n\n\nplot(cv.en, main = \"Elastic net\")\n\n\n\n\n\nxnew &lt;- ozone.X[c(25,30),]\nrownames(xnew) &lt;- NULL\n\n\nxnew\n\n      T12  T15 Ne12 N12 S12 E12 W12   Vx   O3v\n[1,] 13.6 14.4    1   0   0   1   0 3.55  97.8\n[2,] 21.8 23.6    6   4   0   0   0 2.50 112.0\n\npredict(cv.ridge,newx=xnew)\n\n     lambda.1se\n[1,]   90.41122\n[2,]   90.65036\n\n\n\nozone&lt;-read.table(\"../donnees/ozone.txt\",header=TRUE,sep=\";\",row.names = 1)\nozone.X &lt;- model.matrix(O3~.,data=ozone)\nozone.Y &lt;- ozone$O3\ncv.defaut &lt;- cv.glmnet(ozone.X,ozone.Y)\nlassodefaut&lt;-glmnet(ozone.X,ozone.Y,lambda=cv.defaut$lambda.min)\n\n\nozone$vent &lt;- as.factor(ozone$vent)\nozone$vent &lt;- relevel(ozone$vent,ref=\"NORD\")\nozone.X &lt;- model.matrix(O3~.,data=ozone)\ncv.nord &lt;- cv.glmnet(ozone.X,ozone.Y)\nlassonord &lt;- glmnet(ozone.X,ozone.Y,lambda=cv.nord$lambda.min)\n\n\npredict(lassodefaut,ozone.X[1:4,])\n\n               s0\n19960422 73.05686\n19960429 92.67573\n19960506 69.26897\n19960514 80.69977\n\npredict(lassonord,ozone.X[1:4,])\n\n               s0\n19960422 79.43741\n19960429 90.58414\n19960506 74.36556\n19960514 75.06648\n\n\n\nozone.X &lt;- model.matrix(O3~.-vent-nebulosite+C(vent,sum)+\n                          C(nebulosite,sum),data=ozone)\ncv.sum &lt;- cv.glmnet(ozone.X,ozone.Y)\nlassosum &lt;- glmnet(ozone.X,ozone.Y,lambda=cv.sum$lambda.min)\npredict(lassosum,ozone.X[1:4,])\n\n               s0\n19960422 78.05238\n19960429 89.87258\n19960506 75.07092\n19960514 73.93502"
  },
  {
    "objectID": "code/chap6.html",
    "href": "code/chap6.html",
    "title": "6 Variables qualitatives : ANCOVA et ANOVA",
    "section": "",
    "text": "La concentration en ozone\n\nozone &lt;- read.table(\"../donnees/ozone.txt\", header = T, sep = \";\")\nplot(ozone[,\"T12\"], ozone[,\"O3\"],pch=as.numeric(ozone[,\"vent\"]),\n     col = as.numeric(ozone[,\"vent\"]))\na1 &lt;- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"EST\",])\na2 &lt;- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"NORD\",])\na3 &lt;- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"OUEST\",])\na4 &lt;- lm(O3 ~ T12, data = ozone[ozone[,\"vent\"]==\"SUD\",])\nabline(a1, col=1)\nabline(a2, col=2)\nabline(a3, col=3)\nabline(a4, col=4)\n\n\n\n\n\nmod1b &lt;- lm(formula = O3 ~ -1 + vent + T12:vent, data = ozone)\nsummary(mod1b)\n\n\nCall:\nlm(formula = O3 ~ -1 + vent + T12:vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.903  -9.163   1.153  10.319  32.638 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \nventEST        45.6090    13.9343   3.273 0.002133 ** \nventNORD      106.6345    28.0341   3.804 0.000456 ***\nventOUEST      64.6840    24.6208   2.627 0.011967 *  \nventSUD       -27.0602    26.5389  -1.020 0.313737    \nventEST:T12     2.7480     0.6342   4.333 8.96e-05 ***\nventNORD:T12   -1.6491     1.6058  -1.027 0.310327    \nventOUEST:T12   0.3407     1.2047   0.283 0.778709    \nventSUD:T12     5.3786     1.1497   4.678 3.00e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.71 on 42 degrees of freedom\nMultiple R-squared:  0.9773,    Adjusted R-squared:  0.973 \nF-statistic: 226.1 on 8 and 42 DF,  p-value: &lt; 2.2e-16\n\n\n\nmod1 &lt;- lm(formula = O3 ~ vent + T12:vent, data = ozone)\nsummary(mod1)\n\n\nCall:\nlm(formula = O3 ~ vent + T12:vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.903  -9.163   1.153  10.319  32.638 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    45.6090    13.9343   3.273  0.00213 ** \nventNORD       61.0255    31.3061   1.949  0.05796 .  \nventOUEST      19.0751    28.2905   0.674  0.50384    \nventSUD       -72.6691    29.9746  -2.424  0.01972 *  \nventEST:T12     2.7480     0.6342   4.333 8.96e-05 ***\nventNORD:T12   -1.6491     1.6058  -1.027  0.31033    \nventOUEST:T12   0.3407     1.2047   0.283  0.77871    \nventSUD:T12     5.3786     1.1497   4.678 3.00e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.71 on 42 degrees of freedom\nMultiple R-squared:  0.6753,    Adjusted R-squared:  0.6212 \nF-statistic: 12.48 on 7 and 42 DF,  p-value: 1.614e-08\n\n\n\nmod2 &lt;- lm(formula = O3 ~ vent + T12, data = ozone)\nmod2b &lt;- lm(formula = O3 ~ -1 + vent + T12, data = ozone)\nmod3 &lt;- lm(formula = O3 ~ vent:T12, data = ozone)\n\n\nanova(mod2,mod1)\n\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent + T12\nModel 2: O3 ~ vent + T12:vent\n  Res.Df     RSS Df Sum of Sq      F   Pr(&gt;F)   \n1     45 12612.0                                \n2     42  9087.4  3    3524.5 5.4298 0.003011 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nanova(mod3,mod1)\n\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent:T12\nModel 2: O3 ~ vent + T12:vent\n  Res.Df     RSS Df Sum of Sq      F  Pr(&gt;F)  \n1     45 11864.1                              \n2     42  9087.4  3    2776.6 4.2776 0.01008 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nplot(rstudent(mod2) ~ fitted(mod2),xlab=\"ychap\",ylab=\"residus\")\n\n\n\n\n\nlibrary(lattice)\nxyplot(rstudent(mod2)~fitted(mod2)|vent,data = ozone, ylab=\"residus\")\n\n\n\n\n\nmod &lt;- lm(formula = O3 ~ vent + T12 + T12:vent, data = ozone)\n\n\nmod0 &lt;- lm(formula = O3 ~ vent +T12 + T12:vent, data = ozone)\nsummary(mod0)\n\n\nCall:\nlm(formula = O3 ~ vent + T12 + T12:vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.903  -9.163   1.153  10.319  32.638 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    45.6090    13.9343   3.273  0.00213 ** \nventNORD       61.0255    31.3061   1.949  0.05796 .  \nventOUEST      19.0751    28.2905   0.674  0.50384    \nventSUD       -72.6691    29.9746  -2.424  0.01972 *  \nT12             2.7480     0.6342   4.333 8.96e-05 ***\nventNORD:T12   -4.3971     1.7265  -2.547  0.01462 *  \nventOUEST:T12  -2.4073     1.3614  -1.768  0.08429 .  \nventSUD:T12     2.6306     1.3130   2.004  0.05160 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.71 on 42 degrees of freedom\nMultiple R-squared:  0.6753,    Adjusted R-squared:  0.6212 \nF-statistic: 12.48 on 7 and 42 DF,  p-value: 1.614e-08\n\n\n\n\nLa hauteur des eucalyptus\n\neucalypt &lt;- read.table(\"../donnees/eucalyptus.txt\", header = T, sep = \";\")\neucalypt[,\"bloc\"] &lt;- as.factor(eucalypt[,\"bloc\"])\nm.complet &lt;- lm(ht ~ bloc - 1 + bloc:circ, data = eucalypt)\nm.pente &lt;- lm(ht ~ bloc - 1 + circ, data = eucalypt)\nm.ordonne &lt;- lm(ht ~ bloc:circ, data = eucalypt)\nanova(m.pente, m.complet)\n\nAnalysis of Variance Table\n\nModel 1: ht ~ bloc - 1 + circ\nModel 2: ht ~ bloc - 1 + bloc:circ\n  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)\n1   1425 2005.9                           \n2   1423 2005.0  2   0.84752 0.3007 0.7403\n\n\n\nanova(m.ordonne, m.complet)\n\nAnalysis of Variance Table\n\nModel 1: ht ~ bloc:circ\nModel 2: ht ~ bloc - 1 + bloc:circ\n  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)\n1   1425 2009.2                           \n2   1423 2005.0  2    4.1649 1.4779 0.2285\n\n\n\nm.simple &lt;- lm(ht ~ circ, data = eucalypt)\nanova(m.simple, m.pente)\n\nAnalysis of Variance Table\n\nModel 1: ht ~ circ\nModel 2: ht ~ bloc - 1 + circ\n  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    \n1   1427 2052.1                                  \n2   1425 2005.9  2    46.188 16.406 9.031e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nANOVA\n\nmod1 &lt;- lm(O3~vent-1,data=ozone)\nsummary(mod1)\n\n\nCall:\nlm(formula = O3 ~ vent - 1, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n          Estimate Std. Error t value Pr(&gt;|t|)    \nventEST    103.850      4.963   20.92  &lt; 2e-16 ***\nventNORD    78.289      6.618   11.83 1.49e-15 ***\nventOUEST   71.578      4.680   15.30  &lt; 2e-16 ***\nventSUD     94.343      7.504   12.57  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.9547,    Adjusted R-squared:  0.9508 \nF-statistic: 242.4 on 4 and 46 DF,  p-value: &lt; 2.2e-16\n\n\n\nanova(mod1)\n\nAnalysis of Variance Table\n\nResponse: O3\n          Df Sum Sq Mean Sq F value    Pr(&gt;F)    \nvent       4 382244   95561  242.44 &lt; 2.2e-16 ***\nResiduals 46  18131     394                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nmod2 &lt;- lm(O3 ~ vent, data = ozone)\nanova(mod2)\n\nAnalysis of Variance Table\n\nResponse: O3\n          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nvent       3  9859.8  3286.6  8.3383 0.0001556 ***\nResiduals 46 18131.4   394.2                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(mod2)\n\n\nCall:\nlm(formula = O3 ~ vent, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  103.850      4.963  20.923  &lt; 2e-16 ***\nventNORD     -25.561      8.272  -3.090  0.00339 ** \nventOUEST    -32.272      6.821  -4.731 2.16e-05 ***\nventSUD       -9.507      8.997  -1.057  0.29616    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.3522,    Adjusted R-squared:   0.31 \nF-statistic: 8.338 on 3 and 46 DF,  p-value: 0.0001556\n\n\n\nlm(O3 ~ C(vent,treatment), data = ozone)\n\n\nCall:\nlm(formula = O3 ~ C(vent, treatment), data = ozone)\n\nCoefficients:\n            (Intercept)   C(vent, treatment)NORD  C(vent, treatment)OUEST  \n                103.850                  -25.561                  -32.272  \n  C(vent, treatment)SUD  \n                 -9.507  \n\n\n\nlm(O3 ~ C(vent,base=2), data = ozone)\n\n\nCall:\nlm(formula = O3 ~ C(vent, base = 2), data = ozone)\n\nCoefficients:\n           (Intercept)    C(vent, base = 2)EST  C(vent, base = 2)OUEST  \n                78.289                  25.561                  -6.711  \n  C(vent, base = 2)SUD  \n                16.054  \n\n\n\nII &lt;- length(levels(as.factor(ozone$vent)))\nnI &lt;- table(ozone$vent)\ncontraste&lt;-matrix(rbind(diag(II-1),-nI[-II]/nI[II]),II,II-1)\nmod3 &lt;- lm(O3 ~ C(vent,contraste), data = ozone)\nanova(mod3)\n\nAnalysis of Variance Table\n\nResponse: O3\n                   Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nC(vent, contraste)  3  9859.8  3286.6  8.3383 0.0001556 ***\nResiduals          46 18131.4   394.2                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(mod3)\n\n\nCall:\nlm(formula = O3 ~ C(vent, contraste), data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           86.300      2.808  30.737  &lt; 2e-16 ***\nC(vent, contraste)1   17.550      4.093   4.288 9.15e-05 ***\nC(vent, contraste)2   -8.011      5.993  -1.337 0.187858    \nC(vent, contraste)3  -14.722      3.744  -3.933 0.000281 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.3522,    Adjusted R-squared:   0.31 \nF-statistic: 8.338 on 3 and 46 DF,  p-value: 0.0001556\n\n\n\nmod4 &lt;- lm(O3 ~ C(vent,sum), data = ozone) \nanova(mod4)\n\nAnalysis of Variance Table\n\nResponse: O3\n             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nC(vent, sum)  3  9859.8  3286.6  8.3383 0.0001556 ***\nResiduals    46 18131.4   394.2                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(mod4)\n\n\nCall:\nlm(formula = O3 ~ C(vent, sum), data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.250 -13.950  -2.233  14.972  39.857 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     87.015      3.027  28.743  &lt; 2e-16 ***\nC(vent, sum)1   16.835      4.635   3.632 0.000705 ***\nC(vent, sum)2   -8.726      5.573  -1.566 0.124284    \nC(vent, sum)3  -15.437      4.485  -3.442 0.001240 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.85 on 46 degrees of freedom\nMultiple R-squared:  0.3522,    Adjusted R-squared:   0.31 \nF-statistic: 8.338 on 3 and 46 DF,  p-value: 0.0001556\n\n\n\nresid2 &lt;- resid(mod2)\nozone$vent &lt;- as.factor(ozone$vent)\nplot(resid2~vent,data=ozone, ylab=\"residus\")\n\n\n\nplot(resid2 ~ jitter(fitted(mod2)),xlab=\"ychap\",ylab=\"residus\")\n\n\n\nxyplot(resid2 ~ I(1:50)|vent, data=ozone,\n       xlab=\"index\", ylab=\"residus\")\n\n\n\n\n\npar(mfrow=c(1,2))\nwith(ozone, interaction.plot(vent, nebulosite, O3, col=1:2))\nwith(ozone, interaction.plot(nebulosite, vent, O3, col=1:4))\n\n\n\n\n\nmod1 &lt;- lm(O3 ~ vent + nebulosite + vent:nebulosite, data = ozone)\nmod2 &lt;- lm(O3 ~ vent + nebulosite, data = ozone)\nanova(mod2, mod1)\n\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent + nebulosite\nModel 2: O3 ~ vent + nebulosite + vent:nebulosite\n  Res.Df   RSS Df Sum of Sq     F Pr(&gt;F)\n1     45 11730                          \n2     42 11246  3    483.62 0.602 0.6173\n\n\n\nmod3 &lt;- lm(O3 ~ vent, data = ozone)\nanova(mod3, mod2)\n\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent\nModel 2: O3 ~ vent + nebulosite\n  Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    \n1     46 18131                                  \n2     45 11730  1    6401.5 24.558 1.066e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nanova(mod3, mod2, mod1)\n\nAnalysis of Variance Table\n\nModel 1: O3 ~ vent\nModel 2: O3 ~ vent + nebulosite\nModel 3: O3 ~ vent + nebulosite + vent:nebulosite\n  Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    \n1     46 18131                                  \n2     45 11730  1    6401.5 23.907 1.523e-05 ***\n3     42 11246  3     483.6  0.602    0.6173    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nanova(mod1)\n\nAnalysis of Variance Table\n\nResponse: O3\n                Df  Sum Sq Mean Sq F value    Pr(&gt;F)    \nvent             3  9859.8  3286.6  12.274 6.689e-06 ***\nnebulosite       1  6401.5  6401.5  23.907 1.523e-05 ***\nvent:nebulosite  3   483.6   161.2   0.602    0.6173    \nResiduals       42 11246.2   267.8                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "code/chap3.html",
    "href": "code/chap3.html",
    "title": "3 Validation du modèle",
    "section": "",
    "text": "ozone &lt;- read.table(\"../donnees/ozone_long.txt\", header = T, sep = \";\")\nmod.lin6v &lt;- lm(O3~T6 + T12 + Ne12 + Ne15 + Vx + O3v,data=ozone)\n\n\nplot(rstudent(mod.lin6v), pch = \".\",ylab = \"Résidus studentisés par VC\")\nabline(h = c(-2,2))\nlines(lowess(rstudent(mod.lin6v)))\n\n\n\n\n\nplot(mod.lin6v, which = 2, sub = \"\", main = \"\")\nabline(0,1)\n\n\n\n\n\nplot(cooks.distance(mod.lin6v),type=\"h\",ylab=\"Distance de Cook\")\np &lt;- ncol(ozone) ; n &lt;- nrow(ozone)\nseuil1 &lt;- qf(0.1,p,n-p) ; abline(h=seuil1)\n\n\n\ninfl.ozone &lt;- influence.measures(mod.lin6v)\nplot(infl.ozone$infmat[,\"hat\"],type=\"h\",ylab=\"hii\")\nseuil1 &lt;- 3*p/n ; abline(h=seuil1,col=1,lty=2)\nseuil2 &lt;- 2*p/n ; abline(h=seuil2,col=1,lty=3)\n\n\n\n\n\nresidpartiels &lt;- resid(mod.lin6v, type = \"partial\")\nprov &lt;- loess(residpartiels[,\"O3v\"] ~ ozone$O3v)\nordre &lt;- order(ozone$O3v)\nplot(ozone$O3v, residpartiels[,\"O3v\"], pch=\".\",ylab=\"\",xlab=\"\")\nmatlines(ozone$O3v[ordre], predict(prov)[ordre])\nabline(lsfit(ozone$O3v, residpartiels[,\"O3v\"]), lty = 2)"
  },
  {
    "objectID": "code/chap1.html",
    "href": "code/chap1.html",
    "title": "1 Régression simple",
    "section": "",
    "text": "La concentration en ozone\n\nozone &lt;- read.table(\"../donnees/ozone_simple.txt\",header=TRUE,sep=\";\")\nplot(O3~T12, data=ozone, xlab=\"T12\", ylab=\"O3\")\n\n\n\n\n\nreg &lt;- lm(O3~T12, data=ozone)\nsummary(reg)\n\n\nCall:\nlm(formula = O3 ~ T12, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-45.256 -15.326  -3.461  17.634  40.072 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  31.4150    13.0584   2.406     0.02 *  \nT12           2.7010     0.6266   4.311 8.04e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 20.5 on 48 degrees of freedom\nMultiple R-squared:  0.2791,    Adjusted R-squared:  0.2641 \nF-statistic: 18.58 on 1 and 48 DF,  p-value: 8.041e-05\n\n\n\nplot(O3~T12, data=ozone)\nT12 &lt;- seq(min(ozone[,\"T12\"]), max(ozone[,\"T12\"]), length = 100)\ngrille &lt;- data.frame(T12)\nICdte &lt;- predict(reg, new=grille, interval=\"conf\", level=0.95)\nmatlines(grille$T12, cbind(ICdte), lty = c(1,2,2), col = 1)\n\n\n\n\n\nplot(O3~T12, data = ozone, ylim = c(0,150))\nT12 &lt;- seq(min(ozone[,\"T12\"]), max(ozone[,\"T12\"]), length = 100)\ngrille &lt;- data.frame(T12)\nICdte &lt;- predict(reg, new=grille, interval=\"conf\", level=0.95)\nICprev &lt;- predict(reg, new=grille, interval=\"pred\", level=0.95)\nmatlines(T12, cbind(ICdte,ICprev[,-1]), lty=c(1,2,2,3,3), col=1)\nlegend(\"topleft\", lty=2:3, c(\"Y\",\"E(Y)\"))\n\n\n\n\n\nIC &lt;- confint(reg, level = 0.95)\nIC\n\n               2.5 %   97.5 %\n(Intercept) 5.159232 57.67071\nT12         1.441180  3.96089\n\n\n\nlibrary(ellipse)\nplot(ellipse(reg, level=0.95), type = \"l\", xlab = \"\", ylab = \"\")\npoints(coef(reg)[1], coef(reg)[2], pch = 3)\nlines(IC[1,c(1,1,2,2,1)], IC[2,c(1,2,2,1,1)], lty = 2)\n\n\n\n\n\n\nLa hauteur des eucalyptus\n\neucalypt &lt;- read.table(\"../donnees/eucalyptus.txt\", header = T, sep = \";\")\nplot(ht~circ, data = eucalypt, xlab = \"circ\", ylab = \"ht\")\n\n\n\n\n\nreg &lt;- lm(ht~circ, data = eucalypt)\nsummary(reg)\n\n\nCall:\nlm(formula = ht ~ circ, data = eucalypt)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.7659 -0.7802  0.0557  0.8271  3.6913 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 9.037476   0.179802   50.26   &lt;2e-16 ***\ncirc        0.257138   0.003738   68.79   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.199 on 1427 degrees of freedom\nMultiple R-squared:  0.7683,    Adjusted R-squared:  0.7682 \nF-statistic:  4732 on 1 and 1427 DF,  p-value: &lt; 2.2e-16\n\n\n\nplot(ht~circ, data = eucalypt, pch = \"+\", col = \"grey60\")\ngrille &lt;- data.frame(circ = seq(min(eucalypt[,\"circ\"]),\n                                max(eucalypt[,\"circ\"]), length = 100))\nICdte &lt;- predict(reg, new=grille, interval=\"confi\", level=0.95)\nmatlines(grille$circ, ICdte, lty = c(1,2,2), col = 1)\n\n\n\n\n\nplot(ht~circ, data = eucalypt, pch = \"+\", col = \"grey60\")\ncirc &lt;- seq(min(eucalypt[,\"circ\"]),max(eucalypt[,\"circ\"]), len = 100)\ngrille &lt;- data.frame(circ)\nCdte &lt;- predict(reg, new=grille, interval=\"conf\", level=0.95)\nICprev &lt;- predict(reg, new=grille, interval=\"pred\", level=0.95)\nmatlines(circ, cbind(ICdte,ICprev[,-1]),lty=c(1,2,2,3,3), col=1)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "3ème édition",
    "section": "",
    "text": "Les auteurs\n\nPierre-André Cornillon\nNicolas Hengartner\nÉric Matzner-Løber\nLaurent Rouvière\n\n\n\nDescriptif\n\n4e de couverture\nAvant-propos\nSommaire détaillé\n\n\n\nBoutique en ligne\nPar ici"
  },
  {
    "objectID": "donnees.html",
    "href": "donnees.html",
    "title": "Jeux de données",
    "section": "",
    "text": "ad_data.txt\n\nartere.txt\n\neucalyptus.txt\n\nlogit_ex6.csv\nlogit_ridge_lasso.csv\nozone.txt\nozone_complet.txt\nozone_long.txt\nozone_simple.txt\nozone_transf.txt\npanne.txt\npoissonData.csv\npoissonData3.csv"
  },
  {
    "objectID": "donnees.html#liste-des-jeux-de-données-par-ordre-alphabétique",
    "href": "donnees.html#liste-des-jeux-de-données-par-ordre-alphabétique",
    "title": "Jeux de données",
    "section": "",
    "text": "ad_data.txt\n\nartere.txt\n\neucalyptus.txt\n\nlogit_ex6.csv\nlogit_ridge_lasso.csv\nozone.txt\nozone_complet.txt\nozone_long.txt\nozone_simple.txt\nozone_transf.txt\npanne.txt\npoissonData.csv\npoissonData3.csv"
  },
  {
    "objectID": "code/chap2.html",
    "href": "code/chap2.html",
    "title": "2 La régression linéaire multiple",
    "section": "",
    "text": "La concentration en ozone\n\nozone &lt;- read.table(\"../donnees/ozone.txt\", header = T, sep = \";\")\nlibrary(\"scatterplot3d\")\nscatterplot3d(ozone[,\"T12\"],ozone[,\"Vx\"],ozone[,\"O3\"],\n              type=\"h\",pch=16, box=FALSE, xlab=\"T12\", ylab=\"Vx\", zlab=\"O3\")\n\n\n\n\n\nregmulti &lt;- lm(O3~T12+Vx, data = ozone)\nsummary(regmulti)\n\n\nCall:\nlm(formula = O3 ~ T12 + Vx, data = ozone)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-42.984 -10.152  -2.407  11.710  34.494 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  35.4530    10.7446   3.300  0.00185 ** \nT12           2.5380     0.5151   4.927 1.08e-05 ***\nVx            0.8736     0.1772   4.931 1.06e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.82 on 47 degrees of freedom\nMultiple R-squared:  0.5249,    Adjusted R-squared:  0.5047 \nF-statistic: 25.96 on 2 and 47 DF,  p-value: 2.541e-08\n\n\n\n\nLa hauteur des eucalyptus\n\neucalypt &lt;- read.table(\"../donnees/eucalyptus.txt\", header = T, sep = \";\")\nplot(ht~circ, data = eucalypt, xlab = \"circ\", ylab = \"ht\")\n\n\n\n\n\nregmult &lt;- lm(ht ~ circ + I(sqrt(circ)), data = eucalypt)\nresume.mult &lt;- summary(regmult)\nresume.mult\n\n\nCall:\nlm(formula = ht ~ circ + I(sqrt(circ)), data = eucalypt)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.1881 -0.6881  0.0427  0.7927  3.7481 \n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   -24.35200    2.61444  -9.314   &lt;2e-16 ***\ncirc           -0.48295    0.05793  -8.336   &lt;2e-16 ***\nI(sqrt(circ))   9.98689    0.78033  12.798   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.136 on 1426 degrees of freedom\nMultiple R-squared:  0.7922,    Adjusted R-squared:  0.7919 \nF-statistic:  2718 on 2 and 1426 DF,  p-value: &lt; 2.2e-16\n\n\n\nplot(ht ~ circ, data = eucalypt, pch = \"+\", col = \"grey60\")\ngrille &lt;- data.frame(circ = seq(min(eucalypt[,\"circ\"]),max(eucalypt[,\"circ\"]), length = 100))\nlines(grille[,\"circ\"], predict(regmult, grille))"
  },
  {
    "objectID": "code/chap5.html",
    "href": "code/chap5.html",
    "title": "5 Inférence dans le modèle Gaussien",
    "section": "",
    "text": "ozone &lt;- read.table(\"../donnees/ozone.txt\", header = T, sep = \";\")\nmodele3 &lt;- lm(O3 ~ T12 + Vx + Ne12, data = ozone)\nresume3 &lt;- summary(modele3)\ncoef3 &lt;- coef(resume3)\nIC3 &lt;- t(confint(modele3, level = 0.95))\nIC3\n\n       (Intercept)       T12        Vx      Ne12\n2.5 %     57.15842 0.3138112 0.1491857 -6.960609\n97.5 %   111.93625 2.3162807 0.8237055 -2.826137\n\n\n\nlibrary(ellipse)\npar(mfrow=c(3,2))\nfor(i in 1:3){\n  for(j in (i+1):4){\n    plot(ellipse(modele3,c(i,j),level=0.95),type=\"l\",\n         xlab=paste(\"beta\",i,sep=\"\"),ylab=paste(\"beta\",j,sep=\"\"))\n    points(coef(modele3)[i], coef(modele3)[j],pch=3)\n    lines(c(IC3[1,i],IC3[1,i],IC3[2,i],IC3[2,i],IC3[1,i]),\n          c(IC3[1,j],IC3[2,j],IC3[2,j],IC3[1,j],IC3[1,j]),lty=2)\n  }\n}\n\n\n\n\n\nc(resume3$sigma^2*modele3$df.res/qchisq(0.975,modele3$df.res),\n  resume3$sigma^2*modele3$df.res/qchisq(0.025,modele3$df.res))\n\n[1] 133.6699 305.3706\n\n\n\nExemple 1 : la concentration en ozone\n\nmodele3 &lt;- lm(O3 ~ T12 + Vx + Ne12, data = ozone)\nresume3 &lt;- summary(modele3)\nresume3\n\n\nCall:\nlm(formula = O3 ~ T12 + Vx + Ne12, data = ozone)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-29.0461  -8.4824   0.7861   7.7024  28.2916 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  84.5473    13.6067   6.214 1.38e-07 ***\nT12           1.3150     0.4974   2.644  0.01117 *  \nVx            0.4864     0.1675   2.903  0.00565 ** \nNe12         -4.8934     1.0270  -4.765 1.93e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 13.91 on 46 degrees of freedom\nMultiple R-squared:  0.6819,    Adjusted R-squared:  0.6611 \nF-statistic: 32.87 on 3 and 46 DF,  p-value: 1.663e-11\n\n\n\nmodele2 &lt;- lm(O3 ~ T12 + Vx, data = ozone)\nanova(modele2, modele3)\n\nAnalysis of Variance Table\n\nModel 1: O3 ~ T12 + Vx\nModel 2: O3 ~ T12 + Vx + Ne12\n  Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    \n1     47 13299.4                                  \n2     46  8904.6  1    4394.8 22.703 1.927e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nExemple 2 : la hauteur des eucalyptus\n\neucalypt &lt;- read.table(\"../donnees/eucalyptus.txt\", header = T, sep = \";\")\nregsimple &lt;- lm(ht ~ circ, data = eucalypt)\nregM &lt;- lm(ht ~ circ + I(sqrt(circ)), data = eucalypt)\nanova(regsimple, regM)\n\nAnalysis of Variance Table\n\nModel 1: ht ~ circ\nModel 2: ht ~ circ + I(sqrt(circ))\n  Res.Df    RSS Df Sum of Sq     F    Pr(&gt;F)    \n1   1427 2052.1                                 \n2   1426 1840.7  1    211.43 163.8 &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nsummary(regM)\n\n\nCall:\nlm(formula = ht ~ circ + I(sqrt(circ)), data = eucalypt)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.1881 -0.6881  0.0427  0.7927  3.7481 \n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   -24.35200    2.61444  -9.314   &lt;2e-16 ***\ncirc           -0.48295    0.05793  -8.336   &lt;2e-16 ***\nI(sqrt(circ))   9.98689    0.78033  12.798   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.136 on 1426 degrees of freedom\nMultiple R-squared:  0.7922,    Adjusted R-squared:  0.7919 \nF-statistic:  2718 on 2 and 1426 DF,  p-value: &lt; 2.2e-16\n\n\n\ngrille &lt;- data.frame(circ = seq(min(eucalypt[,\"circ\"]),\n                                max(eucalypt[,\"circ\"]), len = 100))\nICdte &lt;- predict(regM,new=grille,interval=\"conf\",level=0.95)\nICpre &lt;- predict(regM,new=grille,interval=\"pred\",level=0.95)\nplot(ht ~ circ, data = eucalypt, pch=\"+\", col=\"grey60\")\nmatlines(grille,cbind(ICdte,ICpre[,-1]),lty=c(1,2,2,3,3),col=1)\nlegend(\"topleft\", lty=2:3, c(\"E(Y)\",\"Y\"))\n\n\n\n\n\n\nIntervalle de confiance bootstrap\n\nmodele3 &lt;- lm(O3 ~ T12 + Vx + Ne12, data = ozone)\n\n\nresume3 &lt;- summary(modele3)\nresume3$coef[,1:2]\n\n              Estimate Std. Error\n(Intercept) 84.5473326 13.6067253\nT12          1.3150459  0.4974102\nVx           0.4864456  0.1675496\nNe12        -4.8933729  1.0269960\n\n\n\nres &lt;- residuals(modele3)\nychap &lt;- predict(modele3)\nCOEFF &lt;- matrix(0, ncol = 4, nrow = 1000)\ncolnames(COEFF) &lt;- names(coef(modele3))\nozone.boot &lt;- ozone\n\n\nfor(i in 1:nrow(COEFF)){\n  resetoile &lt;- sample(res, length(res), replace=T)\n  O3etoile &lt;- ychap + resetoile\n  ozone.boot[,\"O3\"] &lt;- O3etoile\n  regboot &lt;- lm(formula(modele3), data=ozone.boot)\n  COEFF[i,] &lt;- coef(regboot)\n }\n\n\napply(COEFF, 2, quantile, probs = c(0.025,0.975))\n\n      (Intercept)       T12        Vx      Ne12\n2.5%     59.31069 0.3940245 0.2036312 -6.775764\n97.5%   108.67459 2.2270745 0.7974850 -2.900857\n\n\n\nhist(COEFF[,\"T12\"], main = \"\", xlab = \"Coefficient de T12\")"
  },
  {
    "objectID": "code/chap7.html",
    "href": "code/chap7.html",
    "title": "7 Choix de variables",
    "section": "",
    "text": "ozone &lt;- read.table(\"../donnees/ozone.txt\", header = T, sep = \";\")\nlibrary(leaps)\nrecherche &lt;- regsubsets(O3 ~ T12 + T15 + Ne12 + N12 + S12 + E12 + W12 + Vx + O3v, int = T,nbest = 1, nvmax = 10, method = \"exhaustive\", data = ozone)\n\n\nplot(recherche, scale = \"bic\")\n\n\n\nplot(recherche, scale = \"Cp\")\n\n\n\nplot(recherche, scale = \"adjr2\")\n\n\n\nplot(recherche, scale = \"r2\")\n\n\n\n\n\nresume &lt;- summary(recherche)\nnomselec &lt;- colnames(resume$which)[resume$which[which.min(resume$bic),]][-1]\nformule &lt;- formula(paste(\"O3~\",paste(nomselec,collapse=\"+\")))\nmodeleslectionne &lt;- lm(formule, data = ozone)\nmodeleslectionne\n\n\nCall:\nlm(formula = formule, data = ozone)\n\nCoefficients:\n(Intercept)          T15         Ne12           Vx          O3v  \n    61.8252       1.0577      -3.9935       0.3146       0.2629"
  }
]